  <!-- src/app/cv/components/cv-upload/cv-upload.component.html -->
  <div class="upload-container">
    <!-- Alert de notification -->
    <div *ngIf="showAlert"
        class="alert alert-{{ alertType }} alert-dismissible fade show"
        role="alert">
      <i class="bi bi-info-circle-fill me-2" *ngIf="alertType === 'info'"></i>
      <i class="bi bi-check-circle-fill me-2" *ngIf="alertType === 'success'"></i>
      <i class="bi bi-exclamation-triangle-fill me-2" *ngIf="alertType === 'warning'"></i>
      <i class="bi bi-x-circle-fill me-2" *ngIf="alertType === 'danger'"></i>
      {{ alertMessage }}
      <button type="button"
              class="btn-close"
              (click)="dismissAlert()"
              aria-label="Close"></button>
    </div>

    <!-- Carte principale d'upload -->
    <div class="card upload-card">
      <div class="card-header bg-primary text-white">
        <h4 class="card-title mb-0">
          <i class="bi bi-cloud-upload-fill me-2"></i>
          Télécharger un CV
        </h4>
        <p class="card-text mb-0 mt-2 opacity-75">
          <small>
            <i class="bi bi-file-earmark me-1"></i>
            Formats acceptés: PDF, DOCX, DOC, TXT, XLSX, XLS, PPTX, PPT (Max: 16MB)
          </small>
        </p>
      </div>

      <div class="card-body">
        <!-- Zone de drop -->
        <div class="drop-zone"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
            [class.has-file]="selectedFile"
            [class.is-loading]="isLoading">

          <input type="file"
                #fileInput
                hidden
                (change)="onFileSelected($event)"
                accept=".pdf,.docx,.doc,.txt,.xlsx,.xls,.pptx,.ppt">

          <!-- Zone sans fichier -->
          <div *ngIf="!selectedFile" class="drop-zone-content">
            <div class="upload-icon-container">
              <i class="bi bi-cloud-upload upload-icon"></i>
            </div>
            <h5 class="mt-3 mb-2">Glissez-déposez votre CV ici</h5>
            <p class="text-muted mb-3">ou cliquez pour sélectionner un fichier</p>

            <button type="button"
                    class="btn btn-outline-primary btn-lg"
                    (click)="fileInput.click()"
                    [disabled]="isLoading">
              <i class="bi bi-plus-circle me-2"></i>
              Choisir un fichier
            </button>

            <div class="file-format-info mt-3">
              <small class="text-muted">
                <i class="bi bi-info-circle me-1"></i>
                Formats supportés: PDF, Word, Excel, PowerPoint, Texte
              </small>
            </div>
          </div>

          <!-- Zone avec fichier sélectionné -->
          <div *ngIf="selectedFile && !isLoading" class="file-info">
            <div class="file-preview">
              <div class="file-icon-container">
                <i class="file-icon {{ getFileIcon(selectedFile.name) }}"></i>
              </div>

              <div class="file-details">
                <h6 class="file-name">{{ selectedFile.name }}</h6>
                <p class="file-size text-muted mb-2">{{ getFileSize(selectedFile.size) }}</p>

                <!-- Barre de progression de la taille -->
                <div class="progress mb-2" style="height: 4px;">
                  <div class="progress-bar {{ getProgressBarColor() }}"
                      role="progressbar"
                      [style.width.%]="(selectedFile.size / maxFileSize) * 100"
                      [attr.aria-valuenow]="(selectedFile.size / maxFileSize) * 100"
                      aria-valuemin="0"
                      aria-valuemax="100">
                  </div>
                </div>

                <!-- Metadata du fichier -->
                <div class="file-metadata">
                  <span class="badge bg-secondary me-2">
                    <i class="bi bi-calendar me-1"></i>
                    {{ selectedFile.lastModified | date:'dd/MM/yyyy' }}
                  </span>
                  <span class="badge bg-info">
                    <i class="bi bi-file-earmark me-1"></i>
                    {{ selectedFile.type || 'Type inconnu' }}
                  </span>
                </div>
              </div>

              <button type="button"
                      class="btn btn-outline-danger btn-sm"
                      (click)="clearFile()"
                      title="Supprimer le fichier">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>

          <!-- Zone de chargement -->
          <div *ngIf="isLoading" class="loading-state">
            <div class="spinner-container">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Chargement...</span>
              </div>
            </div>
            <h6 class="mt-3 mb-2">Analyse en cours...</h6>
            <p class="text-muted mb-0">
              <small>Extraction des données de votre CV</small>
            </p>

            <!-- Barre de progression indéterminée -->
            <div class="progress mt-3" style="height: 6px;">
              <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                  role="progressbar"
                  style="width: 100%">
              </div>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="actions-container" *ngIf="selectedFile && !isLoading">
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button type="button"
                    class="btn btn-outline-secondary me-md-2"
                    (click)="clearFile()">
              <i class="bi bi-arrow-counterclockwise me-1"></i>
              Changer de fichier
            </button>

            <button type="button"
                    class="btn btn-success btn-lg"
                    (click)="uploadCV()"
                    [disabled]="!selectedFile || isLoading">
              <i class="bi bi-rocket-takeoff me-2"></i>
              Analyser le CV
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Carte d'informations -->
    <div class="card info-card mt-4">
      <div class="card-header">
        <h5 class="card-title mb-0">
          <i class="bi bi-question-circle me-2"></i>
          Comment ça fonctionne ?
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="process-step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h6>
                  <i class="bi bi-upload text-primary me-1"></i>
                  Téléchargement
                </h6>
                <p class="text-muted small mb-0">
                  Uploadez votre CV dans l'un des formats supportés
                </p>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="process-step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h6>
                  <i class="bi bi-cpu text-warning me-1"></i>
                  Analyse IA
                </h6>
                <p class="text-muted small mb-0">
                  Notre système extrait automatiquement les informations
                </p>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="process-step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h6>
                  <i class="bi bi-pencil-square text-info me-1"></i>
                  Vérification
                </h6>
                <p class="text-muted small mb-0">
                  Vérifiez et modifiez les données extraites si nécessaire
                </p>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="process-step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h6>
                  <i class="bi bi-database text-success me-1"></i>
                  Sauvegarde
                </h6>
                <p class="text-muted small mb-0">
                  Stockage sécurisé de votre CV structuré
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Statistiques de support -->
    <div class="card stats-card mt-4">
      <div class="card-body">
        <div class="row text-center">
          <div class="col-md-3">
            <div class="stat-item">
              <i class="bi bi-file-earmark-check stat-icon text-success"></i>
              <h4 class="stat-number">8</h4>
              <p class="stat-label text-muted">Formats supportés</p>
            </div>
          </div>

          <div class="col-md-3">
            <div class="stat-item">
              <i class="bi bi-speedometer2 stat-icon text-primary"></i>
              <h4 class="stat-number">&lt; 30s</h4>
              <p class="stat-label text-muted">Temps d'analyse</p>
            </div>
          </div>

          <div class="col-md-3">
            <div class="stat-item">
              <i class="bi bi-shield-check stat-icon text-info"></i>
              <h4 class="stat-number">100%</h4>
              <p class="stat-label text-muted">Sécurisé</p>
            </div>
          </div>

          <div class="col-md-3">
            <div class="stat-item">
              <i class="bi bi-cloud-arrow-up stat-icon text-warning"></i>
              <h4 class="stat-number">16 MB</h4>
              <p class="stat-label text-muted">Taille max</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  

<!-- Modal pour les doublons -->
<div *ngIf="showDuplicateModal" class="duplicate-modal">
  <div class="modal-content">
    <h4>CV déjà existant</h4>
    <p>Ce CV existe déjà dans la base de données.</p>
    <p>Voulez-vous:</p>
    
    <div *ngIf="isLoading" class="text-center my-3">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <p class="mt-2">Traitement en cours...</p>
    </div>
    
    <div class="modal-actions" *ngIf="!isLoading">
      <button class="btn btn-warning" (click)="replaceExistingCV()">
        Remplacer l'ancien CV
      </button>
      <button class="btn btn-secondary" (click)="closeDuplicateModal()">
        Annuler
      </button>
    </div>
  </div>
</div>